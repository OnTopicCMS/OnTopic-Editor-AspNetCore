@model AttributeViewModel<HtmlAttributeTopicViewModel>

@{
  Layout = "~/Areas/Editor/Views/Editor/Components/_Layout.cshtml";
}

<style type="text/css">
  .Content div.x-tab-panel {
    margin-top: 30px;
  }

  .Content ul.x-tab-strip {
    list-style-image: none;
    padding-left: 0px;
  }
</style>

<textarea
  asp-for                       ="Value"
  rows                          =@Model.AttributeDescriptor.Rows
  columns                       =@Model.AttributeDescriptor.Columns
  class                         =@Model.AttributeDescriptor.CssClass
  placeholder                   =@Model.InheritedValue
  disabled                      =@(!Model.AttributeDescriptor.IsEnabled)
  required                      =@Model.AttributeDescriptor.IsRequired
></textarea>

<script type="text/javascript">
  (function ($) {

    var textareaId      = '@Html.IdFor(m => m.Value)';

    $('[id*="EditorModal"]').on('shown.bs.modal', function(e) {
      $('.Modal [id*="@Html.IdFor(m => m.Value)"]').attr('id', '@Html.IdFor(m => m.Value)_Modal');
      console.log('new id: ' + $('[id*="@Html.IdFor(m => m.Value)"]').attr('id'));
      textareaId = '@Html.IdFor(m => m.Value)_Modal';
      setEditorInstance(textareaId);
      console.log(textareaId);
      return;
    });

    setEditorInstance(textareaId);

  })(jQuery);

  function setEditorInstance(textareaId) {
  //console.log(textareaId + ' on setEditorInstance');
    CKEDITOR.replace(textareaId, {
      height            : '@Model.AttributeDescriptor.Height',
      resize_maxHeight  : '@(Model.AttributeDescriptor.Height+300)',
      customConfig      : '/_content/Ignia.Topics.Editor.Mvc/Shared/Scripts/Vendor/CkEditor/customConfig.js'
    });
  }
</script>